Changelog - 2026-02-02 (v0.70)
===============================

Branch: main

Summary:
--------
Fixed F7A Hornet Mk II missing weapons (nose turret and ball turret).

Changes:
--------
1. Fixed Anvil F7A Hornet Mk II ship spec:
   - Added 2x S3 nose turret guns to pilotWeapons (now 4 total: 2x S4 wing + 2x S3 nose)
   - Added ball turret as a remote turret with 2x S3 guns
   - Ball turret (C5-173f) is pilot-controlled but swappable to TMSB-5

2. Fixed Hornet F7A Mk II PYAM Exec ship spec:
   - Same hardpoint changes as base variant

3. Fixed Hornet F7A Mk II PYAM Exec stock loadout:
   - Added missing pilot weapons (Revenant Gatling x2, NDB-30 Repeater x2)
   - Added missing turret weapons (NDB-30 Repeater x2)

4. Updated extract-ships.js to handle pilot-controlled turrets:
   - extractPilotWeapons() now handles Turret.CanardTurret (nose turrets)
     by counting their weapons as pilot weapons
   - extractTurrets() now handles Turret.BallTurret as a "remote" turret
   - This ensures future ships with similar setups are correctly extracted

Technical Notes:
----------------
- CanardTurret (nose turret): Fixed pilot-controlled turret, guns count as pilot weapons
- BallTurret: Pilot-controlled but swappable, tracked as "remote" turret
- The sync script only adds new ships, so manual fixes won't be overwritten

Files Modified:
---------------
- app.js - Version 0.67 -> 0.70
- index.html - Cache-busting v=67 -> v=70
- data.js - Fixed F7A Hornet Mk II and PYAM Exec ship specs and loadouts
- scripts/extract-ships.js - Handle CanardTurret and BallTurret types

---

Changelog - 2026-02-02 (v0.71)
===============================

Summary:
--------
Added Compact View toggle for hangar display.

Changes:
--------
1. Added Compact View / Detail View toggle button:
   - Button appears next to "# in hangar" text in the MY SHIPS header
   - Clicking toggles between "Compact View" and "Detail View"
   - Compact View shows only ship names with Edit/Delete buttons (one line per ship)
   - Detail View shows full component details (default behavior)

2. CSS additions:
   - .view-toggle-btn styling to match header aesthetic
   - .ships-list.compact-view hides .ship-components
   - Reduced margins in compact mode for tighter display

Files Modified:
---------------
- app.js - Version 0.70 -> 0.71, added toggleViewMode() and isCompactView state
- index.html - Cache-busting v=70 -> v=71
- styles.css - Added compact view styles

---

Changelog - 2026-02-02 (v0.72)
===============================

Summary:
--------
Fixed ship hardpoint extraction bugs and removed "Kruger" prefix from ship names.

Changes:
--------
1. Fixed pilot weapons over-counting in extract-ships.js:
   - Was matching hardpoint_class_* which included missile racks and module mounts
   - Now only counts Turret.GunTurret (gimbals), WeaponGun.Gun, or hardpoint_gun_*
   - F7C Hornet Mk I: 8 pilot weapons -> 2 (correct)

2. Fixed turret weapons double-counting in extract-ships.js:
   - Was counting both gimbal mount AND gun inside = 2x actual count
   - Hurricane turret: 8 guns -> 4 (correct)
   - Hammerhead: 48 guns -> 24 (correct: 6 turrets x 4 guns)

3. Removed "Kruger" prefix from Kruger ship names:
   - "Kruger L-21 Wolf" -> "L-21 Wolf"
   - "Kruger L-22 Alpha Wolf" -> "L-22 Alpha Wolf"
   - "Kruger P-52 Merlin" -> "P-52 Merlin"
   - "Kruger P-72 Archimedes" -> "P-72 Archimedes"
   - Updated both ship specs and stockLoadouts keys

Files Modified:
---------------
- app.js - Version 0.71 -> 0.72
- index.html - Cache-busting v=71 -> v=72
- data.js - Fixed ship specs (142 ships), renamed Kruger ships
- scripts/extract-ships.js - Fixed hardpoint counting bugs

---

Changelog - 2026-02-02 (v0.73 - data fixes)
===========================================

Summary:
--------
Fixed component size extraction bug, synced stock loadouts, and improved extraction scripts.

Changes:
--------
1. Fixed component size extraction bug in extract-ships.js:
   - scunpacked data has MaxSize: 0 for some valid components
   - Added ClassName fallback for shields, coolers, powerPlants (was only QD)
   - Parses size from ClassName pattern (e.g., _S01_ = size 1)
   - L-21 Wolf: shields/powerPlants now size 1 (was 0)
   - RSI Perseus: shields/powerPlants/coolers now size 3 (was 0)

2. Fixed stock loadout incomplete data:
   - Root cause: data.js had stale stockLoadouts that were never synced
   - Created sync-stockloadouts-to-datajs.js to replace stockLoadouts section
   - Hurricane now shows 4 turret weapons (was 1)
   - Hammerhead now shows 24 turret weapons (correct)
   - Synced 214 stock loadouts from new-stockloadouts.js

3. Added Kruger prefix stripping to extraction scripts:
   - update-from-scunpacked.js: cleanShipName() now strips "Kruger " prefix
   - extract-ships.js: Added cleanShipName() for consistent naming
   - Ensures ship names match between extracted data and data.js

4. Created fix-component-sizes.js utility:
   - Updates component sizes in data.js from extracted-ships.js
   - Fixed 72 component size entries total

5. Updated CLAUDE.md with:
   - Key extraction scripts documentation
   - Data pipeline steps
   - Known data quirks (MaxSize: 0, Kruger prefix, snub sizes)

Files Modified:
---------------
- scripts/extract-ships.js - ClassName fallback for all components, cleanShipName()
- scripts/update-from-scunpacked.js - stripPrefixes for Kruger
- scripts/sync-stockloadouts-to-datajs.js - NEW: syncs stock loadouts to data.js
- scripts/fix-component-sizes.js - NEW: fixes component sizes in data.js
- data.js - Fixed 72 component sizes, synced 214 stock loadouts
- CLAUDE.md - Added scripts documentation

Technical Notes:
----------------
- MPUV ships legitimately have size 0 powerPlants/coolers (S00 in ClassName)
- Snub ships have size 0 quantumDrive (no QD equipped)
- sync-ships-to-datajs.js only ADDS new ships, doesn't update existing
- Use fix-component-sizes.js to update existing ship component sizes

---

Changelog - 2026-02-02 (v0.74)
===============================

Summary:
--------
Changed Add Ship dropdown to alphabetical list with manufacturer in parentheses.

Changes:
--------
1. Redesigned ship dropdown in Add Ship modal:
   - Changed from manufacturer-grouped optgroups to flat alphabetical list
   - Format: "Ship Name (Manufacturer)" - e.g., "Gladius (Aegis)"
   - Ships sorted alphabetically by display name
   - Easier to find ships when you know the name but not the manufacturer

Files Modified:
---------------
- app.js - Version 0.73 -> 0.74, rewrote populateShipSelect()
- index.html - Cache-busting v=73 -> v=74

---

Changelog - 2026-02-02 (v0.75)
===============================

Summary:
--------
Fixed turret vs pilot weapon categorization for 34 ships and fixed Corsair ship spec.

Changes:
--------
1. Fixed weapon categorization in extract-loadouts.js:
   - Added TopTurret, BallTurret, and PDC turret detection
   - CanardTurret weapons correctly counted as pilot weapons (fixed nose turrets)
   - Turret-mounted hardpoints now correctly categorized
   - 34 ships had weapons moved from pilotWeapons to turretWeapons

2. Fixed Corsair ship spec in data.js:
   - Added missing remote tail turret (Turret.TopTurret with 2x S2)
   - Now shows 3 turrets: 2 manned + 1 remote
   - 6 pilot weapons + 6 turret weapons (correct)

3. Fixed Mustang Delta pilot weapons:
   - Added rocket support to extract-loadouts.js
   - WeaponGun.Rocket now included (rockets swappable for guns)
   - Mustang Delta: 4 pilot weapons (2x S2 guns + 2x S3 rockets)

4. Added turret type documentation to CLAUDE.md:
   - Documented all turret types (MannedTurret, RemoteTurret, BallTurret, TopTurret, CanardTurret)
   - Documented WeaponGun.Gun and WeaponGun.Rocket weapon types

5. Regenerated processed-data.json with correct weapon categorization

Files Modified:
---------------
- app.js - Version 0.74 -> 0.75
- index.html - Cache-busting v=74 -> v=75
- data.js - Fixed Corsair spec, synced 219 stock loadouts with correct categorization
- scripts/extract-loadouts.js - TopTurret, BallTurret, CanardTurret, rocket detection
- scripts/extract-ships.js - TopTurret detection, rocket support
- processed-data.json - Regenerated with correct data
- CLAUDE.md - Added turret type and weapon type documentation

Technical Notes:
----------------
- TopTurret (Turret.TopTurret): Pilot-controlled rear/tail turret, tracked as remote
- BallTurret (Turret.BallTurret): Pilot-controlled swappable turret, tracked as remote
- CanardTurret (Turret.CanardTurret): Fixed nose turret, weapons count as pilot weapons
- WeaponGun.Rocket: Rockets on hardpoints are swappable with guns, included in weapon counts
- Vanguard Harbinger Jericho rockets are in turret mount (turretWeapons)
- Mustang Delta Jericho rockets are on wing hardpoints (pilotWeapons)
